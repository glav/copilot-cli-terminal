# AGENTS.md

## Project overview

This repository is a small Python setup for starting python developer as quickly as possible using a devcontainer and AI assisted workflows.

The current runtime entrypoint is a minimal script that loads environment variables from a `.env` file (via `python-dotenv`) and prints whether anything was loaded.

## Repo layout

- `src/app.py`: entrypoint; calls `load_env()`
- `src/load_env.py`: `.env` discovery + `python-dotenv` loading
- `pyproject.toml`: Python project metadata + dependencies (managed by `uv`)
- `uv.lock`: resolved dependency lockfile (generated by `uv`)
- `.env-sample`: example environment variables (copy to `.env`)

## Setup

### Install uv

This template uses `uv` for dependency management and virtualenv creation.

- Install (Linux/macOS):

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

If `uv` is installed during devcontainer creation, you may need to restart the terminal so `uv` is on your `PATH`.

### Create a virtual environment + install dependencies

```bash
uv sync
```

### Environment variables

- Copy `.env-sample` to `.env` and fill in real values.
- `.env` is gitignored (see `.gitignore`).

```bash
cp .env-sample .env
```

## Development workflow

### Run the app

From the repository root:

```bash
uv run python src/app.py
```

Notes about `.env` discovery:

- `src/load_env.py` checks for `.env` in the current working directory (`.env`) and one level up (`../.env`).
- If you run from the repo root, put `.env` in the repo root.
- If you run from `src/`, it will also find the repo-root `.env` via `../.env`.

### Copilot / AI Assisted workflow

- All Copilot and AI assisted workflows exist in the .agent directory
- If the user asks about workflows, prompts or other AI assisted ways of working, describe the use and structure of the .agent directory and purpose.

### Source code - MUST
- Any source code should be added to the `src/` directory, for example python files.

### Add new scripts

If you add more Python modules under `src/`, running them as `python3 src/<script>.py` from the repo root will generally keep imports simple.

If you want `python -m ...` module execution, add `src/__init__.py` and switch to package-style imports.

## Testing

No test framework is configured in this template.

- If you add tests, prefer `pytest` and place tests under `tests/`.
- If the intended approach is TDD/BDD (or if there are preferred test tools), confirm with the repo owner/maintainers before standardizing.

## Linting and formatting

This template includes `ruff` as the default linter/formatter.

```bash
uv sync --group dev
uv run ruff check .
uv run ruff format .
```

## Build and deployment

No build/deploy pipeline is defined.

## Security and secrets

- Never commit `.env` or real API keys.
- Treat values in `.env` as secrets.
- Prefer using the dev container/CI secret store (if added later) for production-like runs.

## Troubleshooting

- If `.env` isnâ€™t being loaded, verify you are running from the repo root and that `.env` exists.
- If imports fail, run scripts from the repo root using `python3 src/<script>.py` so `src/` is on `sys.path`.

## Copilot Multi-Persona Workflow

### Per-Persona Custom Instructions

This repository uses copilot-multi with persona-specific custom instructions. Each persona (PM, Impl, Review, Docs) operates within defined role boundaries:

- **PM (Project Manager)**: Located in `.agent/pm-persona.md` - Creates specifications and plans only
- **Impl (Implementation Engineer)**: Located in `.agent/impl-persona.md` - Implements code and fixes bugs
- **Review (Code Review Engineer)**: Located in `.agent/review-persona.md` - Reviews code, provides feedback only
- **Docs (Technical Writer)**: Located in `.agent/docs-persona.md` - Maintains documentation only

When you start copilot-multi, these instructions are automatically loaded via a directory-based mechanism. Each persona runs from its own directory (`.copilot-persona-dirs/{persona}/`) which contains a symlinked `AGENTS.md` file pointing to the persona-specific instructions.

### Using Persona Instructions

**Standard usage** (with persona boundaries):
```bash
uv run copilot-multi start
```

**Disable persona instructions** (all personas behave the same):
```bash
uv run copilot-multi start --no-persona-agents
```

### Customizing Personas

To customize what a persona can do, edit its source file in `.agent/` directory and restart the session:

```bash
# Edit persona instructions
nano .agent/pm-persona.md

# Restart session for changes to take effect
uv run copilot-multi stop
uv run copilot-multi start
```

For detailed documentation on persona instructions, troubleshooting, and advanced usage, see:
**[docs/persona-instructions.md](docs/persona-instructions.md)**
